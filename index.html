<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Record - Work Order</title>
    <style>
        /* Reset and Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Arial', sans-serif;
        }
        
        body {
            background: #f5f5f5;
            padding: 20px;
            color: #333;
        }
        
        /* Service Record Container */
        .service-record {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            box-shadow: 0 5px 30px rgba(0,0,0,0.1);
            border: 1px solid #ddd;
        }
        
        /* Header Section */
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #2c3e50;
        }
        
        .company-name {
            font-size: 28px;
            font-weight: 700;
            color: #2c3e50;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 5px;
        }
        
        .document-title {
            font-size: 32px;
            font-weight: 800;
            color: #e74c3c;
            margin: 10px 0;
            text-transform: uppercase;
        }
        
        .document-subtitle {
            font-size: 18px;
            color: #7f8c8d;
            margin-bottom: 15px;
        }
        
        /* Ticket Info Box */
        .ticket-info-box {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .ticket-id {
            font-size: 24px;
            font-weight: 700;
            font-family: 'Courier New', monospace;
        }
        
        .ticket-date {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .ticket-label {
            font-size: 14px;
            text-transform: uppercase;
            opacity: 0.7;
            margin-bottom: 5px;
            letter-spacing: 1px;
        }
        
        /* Tables Styling */
        .section {
            margin-bottom: 30px;
            page-break-inside: avoid;
        }
        
        .section-title {
            background: #3498db;
            color: white;
            padding: 12px 20px;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        th {
            background: #f8f9fa;
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
            color: #2c3e50;
            border: 1px solid #dee2e6;
            text-transform: uppercase;
            font-size: 13px;
            letter-spacing: 0.5px;
        }
        
        td {
            padding: 12px 15px;
            border: 1px solid #dee2e6;
            vertical-align: top;
        }
        
        /* Checkbox Grid */
        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }
        
        /* Date Time Section */
        .datetime-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
        }
        
        .datetime-item {
            display: flex;
            flex-direction: column;
        }
        
        .datetime-item label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #2c3e50;
        }
        
        .datetime-value {
            font-size: 16px;
            padding: 8px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        /* Text Areas */
        .problem-area, .diagnostics-area, .service-area, .remarks-area {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            line-height: 1.6;
            background: #f8f9fa;
            margin-top: 10px;
            white-space: pre-wrap;
        }
        
        /* Signature Section */
        .signature-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px dashed #ddd;
        }
        
        .signature-box {
            text-align: center;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .signature-line {
            width: 80%;
            height: 1px;
            background: #333;
            margin: 40px auto 10px;
        }
        
        .signature-label {
            font-weight: 600;
            margin-top: 10px;
            color: #2c3e50;
        }
        
        /* Footer */
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            text-align: center;
            color: #7f8c8d;
            font-size: 12px;
        }
        
        .document-code {
            font-family: 'Courier New', monospace;
            color: #e74c3c;
            font-weight: 600;
            margin: 5px 0;
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-print {
            background: #27ae60;
            color: white;
        }
        
        .btn-print:hover {
            background: #219653;
            transform: translateY(-2px);
        }
        
        .btn-close {
            background: #e74c3c;
            color: white;
        }
        
        .btn-close:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }
        
        /* Print Styles */
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .service-record {
                box-shadow: none;
                border: none;
                padding: 15px;
            }
            
            .action-buttons {
                display: none;
            }
            
            .ticket-info-box {
                background: #2c3e50 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .section-title {
                background: #3498db !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            /* Hide checkboxes in print */
            .checkbox-item input[type="checkbox"] {
                display: none;
            }
            
            .checkbox-item:has(input:checked)::before {
                content: "✓ ";
                font-weight: bold;
                color: #27ae60;
            }
            
            .checkbox-item:has(input:not(:checked))::before {
                content: "☐ ";
            }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .service-record {
                padding: 15px;
            }
            
            .ticket-info-box {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            table {
                font-size: 14px;
            }
            
            th, td {
                padding: 8px 10px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="service-record">
        <!-- Header -->
        <div class="header">
            <div class="company-name">SEA LION COMPANY LIMITED</div>
            <div class="document-title">SERVICE RECORD / WORK ORDER</div>
            <div class="document-subtitle">Service & Maintenance Documentation</div>
        </div>
        
        <!-- Ticket Information -->
        <div class="ticket-info-box">
            <div>
                <div class="ticket-label">ZOHO DESK TICKET</div>
                <div class="ticket-id" id="ticketIdDisplay">Loading Ticket ID...</div>
            </div>
            <div>
                <div class="ticket-label">DOCUMENT DATE</div>
                <div class="ticket-date" id="documentDate"></div>
            </div>
            <div>
                <div class="ticket-label">PAGE</div>
                <div class="ticket-date">1 of 1</div>
            </div>
        </div>
        
        <!-- Customer Information -->
        <div class="section">
            <div class="section-title">Customer Information</div>
            <table>
                <thead>
                    <tr>
                        <th width="20%">CUSTOMER TYPE</th>
                        <th width="30%">CUSTOMER NAME</th>
                        <th width="30%">ADDRESS</th>
                        <th width="20%">PHONE NO.</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td id="customerType">Contract / Warranty</td>
                        <td id="customerName">National Health Laboratory</td>
                        <td id="customerAddress">Ziwaka Street</td>
                        <td id="customerPhone">-</td>
                    </tr>
                </tbody>
            </table>
            
            <table style="margin-top: 20px;">
                <thead>
                    <tr>
                        <th>Out of Warranty</th>
                        <th>Service Contract</th>
                        <th>Emergency Service</th>
                        <th>Preventive Maintenance</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="text-align: center;">□</td>
                        <td style="text-align: center;">✓</td>
                        <td style="text-align: center;">□</td>
                        <td style="text-align: center;">✓</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Product Information -->
        <div class="section">
            <div class="section-title">Product & Service Details</div>
            
            <div style="margin: 15px 0;">
                <label style="font-weight: 600; font-size: 16px; color: #2c3e50;">PRODUCT NAME:</label>
                <div style="font-size: 18px; margin-top: 5px; padding: 10px; background: #f8f9fa; border-radius: 4px;">
                    <strong>INS</strong> - Integrated Network System
                </div>
            </div>
            
            <div class="checkbox-grid">
                <div class="checkbox-item">
                    <input type="checkbox" id="preinstall" checked>
                    <label for="preinstall">Pre-Install</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="emg">
                    <label for="emg">EMG</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="pm" checked>
                    <label for="pm">PM</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="fm">
                    <label for="fm">FM</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="training">
                    <label for="training">Training</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="ccc">
                    <label for="ccc">CCC</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="oss">
                    <label for="oss">OSS</label>
                </div>
            </div>
            
            <div style="margin: 20px 0;">
                <label style="font-weight: 600; font-size: 16px; color: #2c3e50;">MODEL and SERIAL NO.:</label>
                <div style="font-size: 16px; margin-top: 5px; padding: 10px; background: #f8f9fa; border-radius: 4px;">
                    INS-2024-MODEL / S/N: <span id="serialNumber">NH2024-001</span>
                </div>
            </div>
            
            <div class="datetime-section">
                <div class="datetime-item">
                    <label>Start Date</label>
                    <div class="datetime-value" id="startDate">12/01/2026</div>
                </div>
                <div class="datetime-item">
                    <label>Start Time</label>
                    <div class="datetime-value" id="startTime">01:26 PM</div>
                </div>
                <div class="datetime-item">
                    <label>End Date</label>
                    <div class="datetime-value" id="endDate">15/01/2026</div>
                </div>
                <div class="datetime-item">
                    <label>End Time</label>
                    <div class="datetime-value" id="endTime">10:47 AM</div>
                </div>
            </div>
        </div>
        
        <!-- Power Supply Check -->
        <div class="section">
            <div class="section-title">Power Supply Check</div>
            <table>
                <thead>
                    <tr>
                        <th>AC Supply</th>
                        <th>Max. V Min.</th>
                        <th>Frequency (Hz)</th>
                        <th>Grounding</th>
                        <th>Remark</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>220-240V</td>
                        <td>230V ± 10%</td>
                        <td>50 Hz</td>
                        <td>Proper</td>
                        <td>Normal</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Problem Description -->
        <div class="section">
            <div class="section-title">Problem Description (Reported by Customer)</div>
            <div class="problem-area" id="problemDescription">
1122026 Ticket Testing - This is a sample problem description from Zoho Desk ticket.
Customer reported system instability during peak hours.
Initial assessment suggests power fluctuation issues.
            </div>
        </div>
        
        <!-- Diagnostics -->
        <div class="section">
            <div class="section-title">Diagnostics</div>
            <div class="diagnostics-area" id="diagnostics">
1. Conducted power supply stability test - PASS
2. Checked network connectivity - Stable
3. Verified system logs for errors
4. Performed hardware diagnostic scan
5. Tested backup power supply system
            </div>
        </div>
        
        <!-- Service Performed -->
        <div class="section">
            <div class="section-title">Service Performed</div>
            <div class="service-area" id="servicePerformed">
• Replaced unstable power regulator unit
• Updated system firmware to latest version
• Calibrated network synchronization
• Performed preventive maintenance cleaning
• Tested all safety interlocks
            </div>
        </div>
        
        <!-- Remarks and Recommendations -->
        <div class="section">
            <div class="section-title">Remarks and Recommendations</div>
            <div class="remarks-area" id="remarks">
System now operating within normal parameters.
Recommend quarterly preventive maintenance.
Suggest UPS upgrade for better power stability.
Customer advised to monitor system logs weekly.
            </div>
        </div>
        
        <!-- Parts Used -->
        <div class="section">
            <div class="section-title">Parts Used Detail</div>
            <table>
                <thead>
                    <tr>
                        <th>ITEM</th>
                        <th>PART NUMBER</th>
                        <th>QTY</th>
                        <th>DESCRIPTION</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>PSU-230-REG</td>
                        <td>1</td>
                        <td>Power Supply Regulator Unit</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>FAN-CPU-120</td>
                        <td>2</td>
                        <td>CPU Cooling Fan 120mm</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>CBL-ETH-5M</td>
                        <td>1</td>
                        <td>Ethernet Cable 5m</td>
                    </tr>
                    <tr>
                        <td colspan="3" style="text-align: right; font-weight: 600;">Total Items:</td>
                        <td style="font-weight: 600;">3</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Service Personnel -->
        <div class="section">
            <div class="section-title">Service Personnel Information</div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 15px;">
                <div>
                    <label style="font-weight: 600; display: block; margin-bottom: 5px;">SERVICE FE NAME:</label>
                    <div style="padding: 10px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa;">
                        Khine Soe (Senior Technician)
                    </div>
                </div>
                <div>
                    <label style="font-weight: 600; display: block; margin-bottom: 5px;">TECHNICIAN ID:</label>
                    <div style="padding: 10px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa;">
                        TECH-2024-012
                    </div>
                </div>
                <div>
                    <label style="font-weight: 600; display: block; margin-bottom: 5px;">CONTACT:</label>
                    <div style="padding: 10px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa;">
                        +95 9 123 456 789
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Signatures -->
        <div class="signature-section">
            <div class="signature-box">
                <div style="font-weight: 600; margin-bottom: 15px; color: #2c3e50;">OFFICE COPY</div>
                <div style="margin-bottom: 20px;">
                    <div style="font-size: 14px; color: #7f8c8d;">Approved by:</div>
                    <div style="font-size: 16px; font-weight: 600; margin-top: 5px;">Service Manager</div>
                </div>
                <div class="signature-line"></div>
                <div class="signature-label">Signature & Stamp</div>
                <div style="margin-top: 15px; font-size: 12px; color: #7f8c8d;">Date: <span id="approvalDate"></span></div>
            </div>
            
            <div class="signature-box">
                <div style="font-weight: 600; margin-bottom: 15px; color: #2c3e50;">CUSTOMER</div>
                <div style="margin-bottom: 20px;">
                    <div style="font-size: 14px; color: #7f8c8d;">Organization:</div>
                    <div style="font-size: 16px; font-weight: 600; margin-top: 5px;">National Health Laboratory</div>
                </div>
                <div class="signature-line"></div>
                <div class="signature-label">Signature & Stamp</div>
                <div style="margin-top: 15px; font-size: 12px; color: #7f8c8d;">Date: <span id="customerDate"></span></div>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="footer">
            <div class="document-code">SL-TSD-F-01</div>
            <div>Version: 1 | Effective Date: 01 March 2019</div>
            <div style="margin-top: 10px; font-size: 11px; color: #95a5a6;">
                This document is generated automatically from Zoho Desk Ticket System. 
                For inquiries, contact: support@sealion.com.mm
            </div>
        </div>
        
        <!-- Action Buttons -->
        <div class="action-buttons no-print">
            <button class="btn btn-print" onclick="printDocument()">
                <i class="fas fa-print"></i> PRINT SERVICE RECORD
            </button>
            <button class="btn btn-close" onclick="closeWindow()">
                <i class="fas fa-times"></i> CLOSE WINDOW
            </button>
        </div>
    </div>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        // Initialize Document
        document.addEventListener('DOMContentLoaded', function() {
            initializeServiceRecord();
            setupPrintShortcut();
        });
        
        function initializeServiceRecord() {
            // Get Ticket ID from URL
            const urlParams = new URLSearchParams(window.location.search);
            const ticketId = urlParams.get('id') || 'NO-TICKET-ID';
            
            console.log('Service Record initialized for Ticket:', ticketId);
            
            // Update Ticket ID Display
            document.getElementById('ticketIdDisplay').textContent = ticketId;
            
            // Set current date
            const now = new Date();
            const formattedDate = formatDate(now);
            document.getElementById('documentDate').textContent = formattedDate;
            document.getElementById('approvalDate').textContent = formattedDate;
            document.getElementById('customerDate').textContent = formattedDate;
            
            // Update page title
            document.title = `Service Record - Ticket ${ticketId}`;
            
            // Generate serial number based on ticket ID
            const serialNumber = 'S/N: ' + ticketId.substring(ticketId.length - 8);
            document.getElementById('serialNumber').textContent = serialNumber;
            
            // Update dates with realistic values
            const startDate = new Date(now);
            startDate.setDate(startDate.getDate() - 3);
            document.getElementById('startDate').textContent = formatDate(startDate, true);
            document.getElementById('startTime').textContent = formatTime(startDate);
            
            const endDate = new Date(now);
            document.getElementById('endDate').textContent = formatDate(endDate, true);
            document.getElementById('endTime').textContent = formatTime(endDate);
            
            // Update problem description with ticket info
            const problemText = document.getElementById('problemDescription').textContent;
            document.getElementById('problemDescription').textContent = 
                `Ticket: ${ticketId}\nDate: ${formattedDate}\n\n${problemText}`;
            
            // Auto-print after 2 seconds (optional)
            // setTimeout(printDocument, 2000);
        }
        
        function formatDate(date, shortFormat = false) {
            const day = date.getDate().toString().padStart(2, '0');
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const year = date.getFullYear();
            
            if (shortFormat) {
                return `${day}/${month}/${year}`;
            }
            
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 
                           'July', 'August', 'September', 'October', 'November', 'December'];
            return `${day} ${months[date.getMonth()]} ${year}`;
        }
        
        function formatTime(date) {
            let hours = date.getHours();
            let minutes = date.getMinutes();
            const ampm = hours >= 12 ? 'PM' : 'AM';
            
            hours = hours % 12;
            hours = hours ? hours : 12; // Convert 0 to 12
            minutes = minutes.toString().padStart(2, '0');
            
            return `${hours}:${minutes} ${ampm}`;
        }
        
        function printDocument() {
            console.log('Printing Service Record...');
            
            // Before print actions
            document.body.classList.add('printing');
            
            // Show print dialog
            window.print();
            
            // After print actions
            setTimeout(() => {
                document.body.classList.remove('printing');
                showPrintCompleteMessage();
            }, 500);
        }
        
        function closeWindow() {
            if (confirm('Close Service Record window?')) {
                window.close();
            }
        }
        
        function setupPrintShortcut() {
            document.addEventListener('keydown', function(e) {
                // Ctrl/Cmd + P = Print
                if ((e.ctrlKey || e.metaKey) && e.key === 'p') {
                    e.preventDefault();
                    printDocument();
                }
                
                // Escape = Close
                if (e.key === 'Escape') {
                    closeWindow();
                }
            });
        }
        
        function showPrintCompleteMessage() {
            // Create notification
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #27ae60;
                color: white;
                padding: 15px 25px;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            notification.innerHTML = '<i class="fas fa-check-circle"></i> Service Record printed successfully!';
            
            // Add animation styles
            if (!document.querySelector('#notification-styles')) {
                const style = document.createElement('style');
                style.id = 'notification-styles';
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
        
        // Initialize when page loads
        window.onload = initializeServiceRecord;
    </script>
</body>
</html>
